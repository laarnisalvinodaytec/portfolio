if (self.CavalryLogger) { CavalryLogger.start_js(["ofXYi"]); }

__d("CINameToImporterMap",[],(function(a,b,c,d,e,f){e.exports={msft:1,yahoo:3,gmail:2,yahoo_jp:22,mailru:30,other:19}}),null);
__d("CIBase",[],(function(a,b,c,d,e,f){__p&&__p();function a(a,b){Object.assign(this,{ci_config:a,element_ids:b});return this}Object.assign(a.prototype,{getElementID:function(a){return this.element_ids[a]},setElementID:function(a,b){this.element_ids[a]=b;return this},setAjaxMode:function(a){this.ajax_mode=a;return this},getConfigData:function(){return{type:this.ci_config.type,flow:this.ci_config.flow,domain_id:this.ci_config.domain_id,import_id:this.ci_config.import_id,tracked_params:this.ci_config.tracked_params,use_case:this.ci_config.use_case,csrf:this.ci_config.csrf}}});e.exports=a}),null);
__d("CIConstants",[],(function(a,b,c,d,e,f){a={importEP:"/contact_importer/ajax/importer.php",addFriendsEP:"/contact_importer/ajax/importer_addfriends.php",inviteEP:"/contact_importer/ajax/importer_invite.php"};e.exports=a}),null);
__d("CIModularController",["Animation","CSS","DOM","UserAgent_DEPRECATED","$","ge"],(function(a,b,c,d,e,f){__p&&__p();var g;a.getInstance=function(){"use strict";return g};a.initInstance=function(a,b,c,d,e){"use strict";a.init(b,c,d,e)};a.handleClickInstance=function(a,b,c){"use strict";g.handleClick(a,b,c)};function a(){"use strict"}a.prototype.init=function(a,b,c,d){"use strict";__p&&__p();g=this;this.$1=a;this.$2=b;this.$3=d;for(var e in a)if(a[e].expanded){this.$4=e;break}if(!c)return;this.$5=c;for(var f in c)if(c[f].selected){this.$6=f;break}};a.prototype.handleClick=function(a,c,d){"use strict";__p&&__p();if(this.$1[a].expanded)return;if(this.$2){var e=new(b("Animation"))(this.getContentElement(a)).from("height",0).to("height","auto").duration(150).show();b("UserAgent_DEPRECATED").ie()!=9&&e.blind();d&&e.ondone(d);e.go();this.$4&&(e=new(b("Animation"))(this.getContentElement(this.$4)).to("height",0).duration(150).hide(),b("UserAgent_DEPRECATED").ie()!=9&&e.blind(),e.go())}else b("CSS").show(this.getContentElement(a)),this.$4&&b("CSS").hide(this.getContentElement(this.$4)),d&&d();b("CSS").toggleClass(b("$")(a),"expanded");this.$4&&(b("CSS").toggleClass(b("$")(this.$4),"expanded"),this.$1[this.$4].expanded=!1);if(!this.$3){e=b("ge")("ci_steplist_3");e&&(this.$1[a].invitable?b("CSS").show(e):b("CSS").hide(e))}this.$1[a].expanded=!0;this.$4=a;if(!c)return;b("CSS").toggleClass(b("$")(c),"selected");this.$6&&(b("CSS").toggleClass(b("$")(this.$6),"selected"),this.$5[this.$6].selected=!1);this.$5[c].selected=!0;this.$6=c};a.prototype.getContentElement=function(a){"use strict";return b("DOM").find(b("$")(a),".ci_module_content")};a.prototype.getFileUploadItemId=function(){"use strict";for(var a in this.$1)if(this.$1[a].key=="other_tools")return a;return null};a.prototype.showHiddenIfNeeded=function(a){"use strict";if(this.$1[a].hidden){a=b("ge")("ci_modules_hidden");a&&(b("CSS").show(a),b("CSS").hide(b("$")("ci_modules_pager")))}};a.prototype.hasFileUpload=function(){"use strict";return this.getFileUploadItemId()?!0:!1};a.prototype.selectFileUpload=function(){"use strict";var a=this.getFileUploadItemId();a&&(this.showHiddenIfNeeded(a),this.handleClick(a,null,function(){var c=b("ge")("ci_fileupload");c&&b("CSS").show(c);c=b("$")(a);c.scrollIntoView(!1)}))};a.prototype.selectNextItem=function(){"use strict";__p&&__p();var a=null,b=null,c=null;for(var d in this.$1){a||(a=d);if(b){c=d;break}this.$1[d].expanded&&(b=d)}b=c||a;b&&(this.showHiddenIfNeeded(b),this.handleClick(b))};e.exports=a}),null);
__d("CIProgressBarDialog",["AsyncRequest","AsyncResponse","Dialog","ProgressBar","bind"],(function(a,b,c,d,e,f){__p&&__p();function g(){Object.assign(this,{dialog:null,progressBar:null,pollCounter:0,title:null,body:null,startTime:null,endpoint:null,importer:null,startedPoll:!1})}g.MAX_POLLS=15;Object.assign(g.prototype,{startTimer:function(){this.startTime=Date.now()},show:function(){this.startTimer();var a=new(b("AsyncRequest"))(this.endpoint).setHandler(b("bind")(this,this.handleAsyncResponse));this.dialog=new(b("Dialog"))().setModal(!0).showLoading().setAsync(a).setCancelHandler(b("bind")(this,this.handleCancelResponse)).show();return this},hide:function(){this.dialog&&(this.dialog.hide(),this.dialog=null)},handleAsyncResponse:function(a){if(!this.startedPoll){a=a.getPayload();a&&a.body&&(this.startedPoll=!0,setTimeout(function(){this.progressBar=new(b("ProgressBar"))(this.dialog.getRoot()),this.poll()}.bind(this),0),this.pollCounter=0)}},poll:function(){if(this.pollCounter>=g.MAX_POLLS){this.hide();return}new(b("AsyncRequest"))().setURI(this.endpoint).setHandler(b("bind")(this,this.handlePollResponse)).setErrorHandler(b("bind")(this,this.handleErrorResponse)).setReadOnly(!0).send();this.pollCounter+=1},handlePollResponse:function(a){a=a.getPayload().progress;if(!a||!this.progressBar||!this.dialog)return;this.setProgress(a);a.state!=2&&a.percent!=100&&setTimeout(this.poll.bind(this),3e3)},handleErrorResponse:function(a){if(!this.dialog)return;this.hide();b("AsyncResponse").defaultErrorHandler(a)},handleCancelResponse:function(){this.importer&&(this.importer.logAsync({login_str:this.importer.getLoginString(),time_ms:Date.now()-this.startTime,cancel_progress_bar:this.progressBar.state||0}),this.importer.async.abandon(),this.importer.async=null),this.hide()},setEndpoint:function(a){this.endpoint=a;return this},setImporter:function(a){this.importer=a;return this},setProgress:function(a){if(!this.progressBar)return;this.progressBar.setTarget(a.percent,2e3);this.progressBar.changeLabel(a.message);return this},setPercent:function(a,b){this.progressBar&&this.progressBar.setTarget(a,b||0);return this},setEnableCrossTransition:function(a){this.dialog.setAllowCrossPageTransition(!0).setAllowCrossQuicklingNavigation(!0);return this}});e.exports=g}),null);
__d("CIInputController",["Arbiter","AsyncRequest","AsyncResponse","AsyncSignal","CIBase","CIConstants","CIModularController","CIProgressBarDialog","CSS","DOM","Form","URI","UserAgent_DEPRECATED","Vector","bind","ge"],(function(a,b,c,d,e,f){__p&&__p();var g;a=babelHelpers.inherits(h,b("CIBase"));g=a&&a.prototype;function h(a,b,c,d,e){"use strict";g.constructor.call(this,a,b);g.setAjaxMode.call(this,d);this.enableProgressBar=e||!1;return this}h.prototype.onSubmit=function(a){"use strict";if(this.disabled)return!1;if(!this.getLoginString()){this.showEmailMissingError();return!1}else this.hideEmailMissingError();return this._submitLoginForm(a)};h.prototype.hideProgressDialog=function(){"use strict";this.progress_dialog&&this.progress_dialog.hide()};h.prototype.showEmailMissingError=function(){"use strict";var a=b("DOM").find(this.getFormElement(),".ci_error_row");b("CSS").show(a);b("CSS").addClass(this.getLoginElement(),"email_missing_error")};h.prototype.hideEmailMissingError=function(){"use strict";var a=b("DOM").find(this.getFormElement(),".ci_error_row");b("CSS").hide(a);b("CSS").removeClass(this.getLoginElement(),"email_missing_error")};h.prototype.startProgressBar=function(){"use strict";var a={};this.ci_config.use_case&&(a.use_case=this.ci_config.use_case);a.flow=this.ci_config.flow;var c=new(b("URI"))(this.ci_config.progress_endpoint);c.addQueryData(a);this.progress_dialog=new(b("CIProgressBarDialog"))().setEndpoint(c).setImporter(this).show()};h.prototype.enableUserInput=function(){"use strict";this.disabled=!1;var a=b("ge")("upload_iframe");a&&b("CSS").show(a)};h.prototype._submitLoginForm=function(a){"use strict";__p&&__p();var c=this.getFormElement();c=(c.getAttributeNode("action")||{}).value;var d=this.getSerializedForm();this.ci_config.use_case&&(d.use_case=this.ci_config.use_case);d.csrf=this.ci_config.csrf;d.ext_sessions=h.getDetectedSessionsStr();a&&Object.assign(d,a);if(a&&a.full_post||!this.ajax_mode){setTimeout(function(){b("Form").post(this.ci_config.full_endpoint,d)}.bind(this),0);return!1}a=new(b("AsyncRequest"))();c=b("CIConstants").importEP;d.has_file_upload=b("CIModularController").getInstance()&&b("CIModularController").getInstance().hasFileUpload()?1:0;this.disabled=!0;a.setURI(c).setData(d).setHandler(b("bind")(this,function(a){this.handleLoginSubmit(a.getPayload()),this.enableUserInput()})).setErrorHandler(b("bind")(this,function(a){this.enableUserInput(),this.progress_dialog&&this.progress_dialog.hide(),b("AsyncResponse").defaultErrorHandler(a)})).setStatusElement(this.getStatusElement());this.enableProgressBar&&this.startProgressBar();h.instance=this;a.send();this.ci_config.should_log_tti&&(window.ciSubmitTime=Date.now());this.async=a;return!1};h.prototype.getSerializedForm=function(){"use strict";var a=this.getFormElement();a=b("Form").serialize(a);var c=this.getLoginElement();c&&(a[c.name]=this.getLoginString());return a};h.prototype.handleLoginSubmit=function(a){"use strict";__p&&__p();this.disabled=!1;if(a&&a.progress&&this.progress_dialog){var c=a.progress;this.progress_dialog.setProgress(c)}if(a&&a.content){c=this.getContainerElement();b("DOM").replace(c,a.content)}if(a&&a.skipnuxstep){this.progress_dialog&&this.progress_dialog.setPercent(100,0).setEnableCrossTransition(!0);b("Arbiter").inform("contact_importer/no_contacts");return}this.progress_dialog&&this.progress_dialog.hide()};h.prototype.submitChallengeDialog=function(a){"use strict";__p&&__p();var c=b("DOM").find(a.getContentNode(),"form");a=a.getFormData();c=(c.getAttributeNode("action")||{}).value;a.ext_sessions=h.getDetectedSessionsStr();c=new(b("AsyncRequest"))().setOption("jsonp",!0).setMethod("GET").setReadOnly(!0).setURI(c).setData(a).setHandler(b("bind")(this,function(a){this.handleLoginSubmit(a.getPayload())})).setErrorHandler(b("bind")(this,function(a){this.progress_dialog.hide(),b("AsyncResponse").defaultErrorHandler(a)})).setStatusElement(this.getFormElement());c.addStatusIndicator();this.startProgressBar();c.send()};h.prototype.tryFileUpload=function(){"use strict";b("CIModularController").getInstance().selectFileUpload()};h.prototype.tryAnotherImporter=function(){"use strict";b("CIModularController").getInstance().selectNextItem()};h.prototype.getLoginString=function(){"use strict";return this.getLoginElement()?this.getLoginElement().value.trim():""};h.prototype.openAPIPopup=function(a,c,d){"use strict";__p&&__p();var e=this.getConfigData();Object.assign(e,{api_instance:a,login_str:c});d&&(e.api_ver=d);e.ext_sessions=h.getDetectedSessionsStr();c=new(b("URI"))(this.ci_config.api_endpoint).addQueryData(e);d=0;e=0;a==1?(d=600,e=500):a==2?(d=600,e=450):a==3?(d=500,e=500):a==22?(d=1e3,e=850):a==29?(d=620,e=490):(d=830,e=600);a=window.screenLeft||window.screenX||0;var f=window.screenTop||window.screenY||0,g=b("Vector").getViewportDimensions();a=a+(g.x-d)/2;g=f+115;f="height="+e+",width="+d+",left="+a+",top="+g+",resizable=1,scrollbars=1,toolbar=0,status=0";e="dialogHeight="+e+"px;dialogWidth="+d+"px;dialogLeft="+a+"px;dialogTop="+g+"px;center=1;resizable=1;status=0;";this.supportShowModalDialog()?(this.apiWindow=window.showModalDialog(c,"api_contact_importer",e),this.isModal=!0):(this.apiWindow=window.open(c,"api_contact_importer",f),this.apiWindow&&this.apiWindow.focus())};h.prototype.supportShowModalDialog=function(){"use strict";return window.showModalDialog&&b("UserAgent_DEPRECATED").firefox()};h.prototype.processToken=function(a,b,c,d){"use strict";a={api_instance:a,auth_token:b,auth_crypt:Boolean(c)};d&&(a.api_ver=d);this._submitLoginForm(a)};h.prototype.getFormElement=function(){"use strict";return b("ge")(this.getElementID("form"))};h.prototype.getLoginElement=function(){"use strict";return b("ge")(this.getElementID("login_input"))};h.prototype.getContainerElement=function(){"use strict";return b("ge")(this.getElementID("contacts_container"))};h.prototype.getStatusElement=function(){"use strict";return b("ge")(this.getElementID("form"))};h.prototype.logAsync=function(a){"use strict";a=babelHelpers["extends"]({},a,this.getConfigData());new(b("AsyncSignal"))(this.ci_config.log_endpoint,a).send()};h.getDetectedSessionsStr=function(){"use strict";var a="";for(var b in h.detectedSessions)a+=b+":"+h.detectedSessions[b]+"|";return a};h.getExtSessionUsername=function(a){"use strict";a=h.detectedSessions[a];return a===undefined?null:a};h.processExtSessionDetection=function(a,b,c){"use strict";if(!c)return;(b===null||b==="")&&(b="*");(h.detectedSessions[a]===undefined||h.detectedSessions[a]==="*")&&(h.detectedSessions[a]=b)};Object.assign(h,{instance:null,detectedSessions:{}});Object.assign(h.prototype,{progress_dialog:null,async:null});e.exports=h}),null);
__d("CIInputlessController",["CIInputController"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("CIInputController"));g=c&&c.prototype;function a(a,b,c,d,e){"use strict";g.constructor.call(this,a,b,c,d,e);return this}a.prototype.onSubmit=function(a){"use strict";var c=this.getSerializedForm();if(c.use_api_popup&&c.api_instance){b("CIInputController").instance=this;this.openAPIPopup(c.api_instance,"");return!1}return this._submitLoginForm(a)};e.exports=a}),null);
__d("CIWebmailValidator",["AsyncRequest","URI"],(function(a,b,c,d,e,f){__p&&__p();var g,h=!1,i=!1,j=[];function k(a){__p&&__p();var b=a.tokens;delete a.tokens;for(var c in a){var d=a[c];for(var e in b){if(!Object.prototype.hasOwnProperty.call(b,e))continue;var f=e.replace(/([.?*+\^$\[\]\\(){}\-])/g,"\\$1");f=new RegExp(f,"g");d=d.replace(f,b[e])}a[c]=d}g=a;h=!0;while(j.length>0)j.shift()()}a={flow:null,useCase:null,hasFullMapping:function(){return h},init:function(a,b,c){!h&&!i&&(g=a),this.flow=b,this.useCase=c},isValidEmail:function(a){var b=new RegExp(/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return b.test(a)},getDomain:function(a){a=a.split("@");return a[1]},getDomainImporterName:function(a){__p&&__p();var b=["msft","yahoo","gmail","yahoo_jp","ezweb_jp","mailru","other"];a=a.split(/\./);for(var c=0;c<a.length-1;c++){var d=a.slice(c).join(".");d="|"+d.toLowerCase();for(var e=0;e<b.length;e++){var f=b[e];if(g[f].indexOf(d)!=-1)return f}}return null},getImporterName:function(a){return this.getDomainImporterName(this.getDomain(a))},isLiveDomain:function(a){return this.getImporterName(a)=="msft"},isGmailDomain:function(a){return this.getImporterName(a)=="gmail"},isYahooDomain:function(a){return this.getImporterName(a)=="yahoo"},isYahooJpDomain:function(a){return this.getImporterName(a)=="yahoo_jp"},isSupportedDomain:function(a){a=this.getDomainImporterName(this.getDomain(a));return a!=null},downloadDomainMapping:function(a){if(h){a&&a();return}a&&j.push(a);a=new(b("URI"))("/contact_importer/ajax/get_domains.php").addQueryData({flow:this.flow,use_case:this.useCase});i||(i=!0,new(b("AsyncRequest"))().setURI(a).setMethod("GET").setReadOnly(!0).setHandler(function(a){a=a.getPayload();k(a)}).send())},setDomainMapping:function(a){k(a)}};e.exports=a}),null);
__d("CIWebmailInputController",["Arbiter","CIInputController","CINameToImporterMap","CIWebmailValidator","CSS","DOM","Event","Keys","$","ge"],(function(a,b,c,d,e,f){__p&&__p();var g;d=babelHelpers.inherits(c,b("CIInputController"));g=d&&d.prototype;function c(a,c,d,e,f,h){"use strict";__p&&__p();g.constructor.call(this,a,c,d,e,f);this.enabledApis=h||{};this.login_str=null;this.ms_login=null;this.timer=null;this.importer_widget=this.getWidget();a=b("CIWebmailValidator").downloadDomainMapping.bind(b("CIWebmailValidator"),null);b("Event").listen(this.importer_widget,"mouseover",a);c=this.getLoginElement();c&&(b("Event").listen(c,"focus",a),b("Event").listen(c,"change",this.validate.bind(this)),b("Event").listen(c,"keydown",this.onKeyDown.bind(this)),b("Event").listen(c,"keydown",a));b("CIInputController").instance=this;return this}c.prototype.onSubmit=function(a){"use strict";b("CIWebmailValidator").isSupportedDomain(this.getLoginString())?this._onSubmit(a):b("CIWebmailValidator").downloadDomainMapping(this._onSubmit.bind(this,a))};c.prototype._onSubmit=function(c){"use strict";__p&&__p();try{b("CIInputController").instance=this;this.deferred&&clearTimeout(this.deferred);if(!this.validate())return!1;c=this.getLoginString();var d=this.getAPIInstance(c),e=a.CINuxToDoWebmailInputController&&this instanceof a.CINuxToDoWebmailInputController&&b("CIWebmailValidator").isGmailDomain(c);e&&(d=2);e=this.getPassword();if(d){this.openAPIPopup(d,c,null);e&&(e.value="");return!1}return g.onSubmit.call(this,{})}catch(a){d={js_error:a.message};this.logAsync(d);return!1}};c.prototype.validate=function(){"use strict";__p&&__p();var a=this.getLoginString();this.login_str=a;if(!a){this.setDefault();this.showEmailMissingError();return!1}this.hideEmailMissingError();var c=b("CIWebmailValidator");if(!c.isValidEmail(a)){this.setDefault();return!1}if(c.isSupportedDomain(a)){c=this.getAPIInstance(a);c?this.setAPI():this.setValid();return!0}else{b("CIWebmailValidator").hasFullMapping()?this.setUnsupported():(this.setWaiting(),b("CIWebmailValidator").downloadDomainMapping(this.validate.bind(this)));return!1}};c.prototype.setValid=function(){"use strict";this.enablePassword(),b("CSS").setClass(this.importer_widget,"valid")};c.prototype.setWaiting=function(){"use strict";b("CSS").setClass(this.importer_widget,"waiting")};c.prototype.setUnsupported=function(){"use strict";b("CSS").setClass(this.importer_widget,"unsupported"),this.disablePassword(),this.logAsync({unsupported_login:this.login_str})};c.prototype.setAPI=function(){"use strict";b("CSS").setClass(this.importer_widget,"api"),this.disablePassword()};c.prototype.setDefault=function(){"use strict";b("CSS").setClass(this.importer_widget,"default"),this.enablePassword()};c.prototype.onKeyDown=function(a){"use strict";this.deferred&&clearTimeout(this.deferred);a=b("Event").getKeyCode(a);if(!a||a==b("Keys").RETURN||a==b("Keys").TAB)return;this.deferred=setTimeout(this.updateDisplayOnKeyEvent.bind(this),300)};c.prototype.updateDisplayOnKeyEvent=function(){"use strict";__p&&__p();var a=this.getLoginString();if(b("CIWebmailValidator").isValidEmail(a)&&this.getAPIInstance(a)){this.setAPI();return}if(b("CSS").hasClass(this.importer_widget,"unsupported")){this.setDefault();return}};c.prototype.canHidePassword=function(){"use strict";return!b("CSS").hasClass(this.importer_widget,"default")};c.prototype.disablePassword=function(){"use strict";if(!this.canHidePassword())return;var a=b("DOM").find(this.getFormElement(),".ci_password_row");b("CSS").hide(a);b("Arbiter").inform("ContactImporter/passwordRowHidden",{form:this.importer_widget},"event")};c.prototype.enablePassword=function(){"use strict";var a=b("DOM").find(this.getFormElement(),".ci_password_row");b("CSS").show(a);b("Arbiter").inform("ContactImporter/passwordRowShown",{form:this.importer_widget},"event")};c.prototype.getWidget=function(){"use strict";return b("$")(this.getElementID("widget"))};c.prototype.getPassword=function(){"use strict";return b("ge")(this.getElementID("password"))};c.prototype.getAPIInstance=function(a){"use strict";a=b("CIWebmailValidator").getImporterName(a);if(!a)return null;a=b("CINameToImporterMap")[a];return a&&this.enabledApis[a]?a:null};c.prototype.getLoginString=function(){"use strict";var a=g.getLoginString.call(this);return a&&this.shouldImplyDomain()?a+"@"+this.ci_config.domain:a};c.prototype.shouldImplyDomain=function(){"use strict";return this.ci_config.domain&&g.getLoginString.call(this).indexOf("@")==-1};c.prototype.getSerializedForm=function(){"use strict";var a=g.getSerializedForm.call(this);this.shouldImplyDomain()&&(a.domain_was_implied=!0);return a};e.exports=c}),null);
__d("CIWlmInputController",["CIInputController"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("CIInputController"));g=c&&c.prototype;function a(a,b,c,d,e){"use strict";g.constructor.call(this,a,b,c,d,!1);Object.assign(this,{api_instance:e});return this}a.prototype.onSubmit=function(){"use strict";b("CIInputController").instance=this;var a=this.getLoginString();this.openAPIPopup(this.api_instance,a,null);return!1};e.exports=a}),null);
__d("legacy:contact-importer-input-controller",["CIInputController"],(function(a,b,c,d,e,f){a.CIInputController=b("CIInputController")}),3);
__d("legacy:contact-importer-inputless-controller",["CIInputlessController"],(function(a,b,c,d,e,f){a.CIInputlessController=b("CIInputlessController")}),3);
__d("legacy:contact-importer-webmail",["CIWebmailInputController"],(function(a,b,c,d,e,f){a.CIWebmailInputController=b("CIWebmailInputController")}),3);
__d("legacy:contact-importer-wlm-controller",["CIWlmInputController"],(function(a,b,c,d,e,f){a.CIWlmInputController=b("CIWlmInputController")}),3);
__d("FastIDVTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:FastIDVLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:FastIDVLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:FastIDVLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setContactPoint=function(a){this.$1.contact_point=a;return this};a.prototype.setCurrentTime=function(a){this.$1.current_time=a;return this};a.prototype.setEntryPoint=function(a){this.$1.entry_point=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setIsFastidv=function(a){this.$1.is_fastidv=a;return this};a.prototype.setStatus=function(a){this.$1.status=a;return this};c={contact_point:!0,current_time:!0,entry_point:!0,event:!0,is_fastidv:!0,status:!0};e.exports=a}),null);
__d("OpenIDConnectCookieDialogStore",["WebStorage"],(function(a,b,c,d,e,f){var g="fastidv_dialog_declined";a={hasDeclinedKey:function(){var a=b("WebStorage").getLocalStorage();return!a?!1:a.getItem(g)==="true"},setDeclinedKey:function(){var a=b("WebStorage").getLocalStorage();if(!a)return;b("WebStorage").setItemGuarded(a,g,"true")}};e.exports=a}),null);
__d("XOpenIDConnectFastIDVProcessController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/oauth2/process/",{state:{type:"String"},id_token:{type:"String"},error:{type:"String"}})}),null);
__d("OpenIDConnectAuthentication",["cx","fbt","AsyncRequest","BanzaiODS","Dialog","DOM","OpenIDConnectCookieDialogStore","PopupWindow","ReloadPage","URI","XOpenIDConnectFastIDVProcessController","FastIDVTypedLogger"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i="nux_confirmation",j="nux_oauth",k="cliff_confirmation",l="banner_confirmation",m="account_recovery",n={saveAndPassParamsBackToServer:function(a){a=n.getProcessTokenURI(a);new(b("AsyncRequest"))().setURI(a).send()},handleFastIDVResponse:function(a){__p&&__p();var b=document.getElementById("email_confirmation_button"),c=document.getElementById("email_confirmation_async_status");b&&(b.disabled=!0,CSS.addClass(b,"_42fr"));c&&CSS.show(c);window.addEventListener("load",setTimeout(function(){if(b&&b.disabled){var a={};a.timeout=!0;n.completeAuth(a)}},2e4));this.saveAndPassParamsBackToServer(a)},getProcessTokenURI:function(a){__p&&__p();var c=b("XOpenIDConnectFastIDVProcessController").getURIBuilder();if(!a)return c.getURI();a=new(b("URI"))("https://www.facebook.com?"+a);a=a.getQueryData();var d=a.state,e=a.id_token;a=a.error;d&&c.setString("state",d);e&&c.setString("id_token",e);a&&c.setString("error",a);return c.getURI()},getParams:function(){var a=window.location.hash;a&&(a=a.substring(1));try{window.opener.OpenIDConnectAuthentication.handleFastIDVResponse(a)}catch(a){}window.close()},startAuth:function(a,c){c===void 0&&(c="unknown");var d=b("PopupWindow").open(a,700,600);new(b("FastIDVTypedLogger"))().setEvent("window_open").setIsFastidv(a.indexOf("id_token")>-1).setContactPoint(new(b("URI"))(a).getQueryData().login_hint).setCurrentTime(Date.now()).setEntryPoint(c).log();b("BanzaiODS").bumpEntityKey("growth","oauth_clicked."+c);d||b("BanzaiODS").bumpEntityKey("growth","email_confirmation.popup_blocked")},registerStartAuth:function(a,b,c){c===void 0&&(c="unknown"),a.addEventListener("click",function(){n.startAuth(b,c)})},registerStartAuthWithDialog:function(a,c,d,e){var f=b("OpenIDConnectCookieDialogStore").hasDeclinedKey();e&&!f&&(e.show(),b("BanzaiODS").bumpEntityKey("growth","gmail_confirmation_dialog.rendered"));a&&c&&this.registerStartAuth(a,c,"dialog");d&&e&&d.addEventListener("click",function(){e.hide(),b("OpenIDConnectCookieDialogStore").setDeclinedKey(),b("BanzaiODS").bumpEntityKey("growth","gmail_confirmation_dialog.hide")})},completeAuth:function(a){var c=new(b("FastIDVTypedLogger"))().setEvent("complete").setCurrentTime(Date.now());"init_email"in a&&c.setContactPoint(a.init_email);var d=document.getElementById("email_confirmation_button"),e=document.getElementById("email_confirmation_async_status");d&&(d.disabled=!1,CSS.removeClass(d,"_42fr"));e&&CSS.hide(e);"timeout"in a?(this.handleError(a),c.setStatus("timeout")):"reauth_url"in a?(this.handleEmailMismatch(a),c.setStatus("email_mismatch")):"error"in a?(this.handleError(a),c.setStatus("error")):(this.handleSuccess(a),c.setStatus("success"));c.log()},handleError:function(a){var c="";"init_email"in a?c=h._("Email verification failed for {email}. Please try again.",[h._param("email",a.init_email)]):c=h._("Email verification failed. Please try again.");new(b("Dialog"))().setModal(!0).setTitle(h._("Error Occurred")).setBody(c).setButtons(b("Dialog").OK).show()},handleSuccess:function(a){__p&&__p();var c=Object.assign({},a);new(b("Dialog"))().setModal(!0).setTitle(this.successMessageTitle(c.flow)).setBody(this.successMessageBody(c.flow)).setButtons(b("Dialog").OK).setHandler(function(){__p&&__p();switch(c.flow){case k:window.location="/home.php";break;case i:window.NUXWizard&&window.NUXWizard.navigation?window.NUXWizard.navigation.goSubmit():b("ReloadPage").now();break;case j:window.NUXWizard&&window.NUXWizard.navigation?window.NUXWizard.navigation.goSubmit():b("ReloadPage").now();break;case l:b("ReloadPage").now();break;case m:window.location=c.redirect_uri;break}}).show()},handleEmailMismatch:function(a){var c=h._("Change Email?"),d=b("DOM").create("b",{},a.auth_email);d=h._("It looks like you signed into Gmail with a different email than the one you originally entered. Please confirm that you want to use {auth_email} to log into Facebook.",[h._param("auth_email",d)]);new(b("Dialog"))().setModal(!0).setTitle(c).setBody(d).setButtons([{name:"continue_change",label:h._("Change Email"),handler:function(){n.startAuth(a.reauth_url,"mismatch")}},b("Dialog").CANCEL]).show()},successMessageTitle:function(a){switch(a){case l:case j:case k:return h._("Account Confirmed");case i:return h._("No Contacts");case m:return h._("Email Verified")}},successMessageBody:function(a){switch(a){case l:case j:case k:return h._("Your account has been confirmed. You can now use all of Facebook's features and connect with friends.");case i:return h._("We couldn't find any contacts.");case m:return h._("Your email has been verified successfully. You can now reset the password for your account.")}}};e.exports=n;a.OpenIDConnectAuthentication=n}),null);
__d("XFBConfirmationCliffTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:XFBConfirmationCliffLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:XFBConfirmationCliffLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:XFBConfirmationCliffLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setCliffCaller=function(a){this.$1.cliff_caller=a;return this};a.prototype.setError=function(a){this.$1.error=a;return this};a.prototype.setSurface=function(a){this.$1.surface=a;return this};a.prototype.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};var g={cliff_caller:!0,error:!0,surface:!0};e.exports=a}),null);
__d("XFBConfirmationCliff",["XFBConfirmationCliffTypedLogger"],(function(a,b,c,d,e,f){c={logCliff:function(event,a){if(event==="banner_seen"){var c=document.getElementsByClassName("hideBanner");if(c.length>0)return}new(b("XFBConfirmationCliffTypedLogger"))().setSurface(event).setCliffCaller(a).log()}};e.exports=c;a.XFBConfirmationCliff=c}),null);
__d("WebFriendingRequests",["Arbiter","DOM","DOMQuery","Event","FriendRequestIHEventLogger","MarauderLogger","PymkFunnelLogger","Vector","debounceCore"],(function(a,b,c,d,e,f){__p&&__p();a={init:function(a,c){__p&&__p();this._pymkBox=a;this._lastPymkSeen=-1;this._recordPYMKImpression();b("Event").listen(window,"scroll",b("debounceCore")(this._recordPYMKImpression.bind(this),100));b("Event").listen(window,"resize",b("debounceCore")(this._recordPYMKImpression.bind(this),100));b("Arbiter").subscribe("pymk-x-out",this._handleXout.bind(this));this._requestsBox=c;if(!this._requestsBox)return;this._lastRequestSeen=-1;this._recordFriendRequestImpression();b("Event").listen(window,"scroll",b("debounceCore")(this._recordFriendRequestImpression.bind(this),100));b("Event").listen(window,"resize",b("debounceCore")(this._recordFriendRequestImpression.bind(this),100))},_recordPYMKImpression:function(){__p&&__p();var a=b("DOM").scry(this._pymkBox,"li.friendBrowserListUnit"),c=b("Vector").getViewportDimensions().y,d=a.length-1;while(d>this._lastPymkSeen){var e=b("Vector").getElementPosition(a[d],"viewport").y;if(e>0&&e+b("Vector").getElementDimensions(a[d]).y<=c)break;d-=1}e=d;while(d>this._lastPymkSeen)this.logPYMKImpression(a[d],"friends_center"),d-=1;this._lastPymkSeen=Math.max(this._lastPymkSeen,e)},_recordFriendRequestImpression:function(){__p&&__p();var a=b("DOM").scry(this._requestsBox,"div.friendRequestItem"),c=b("Vector").getViewportDimensions().y,d=a.length-1;while(d>this._lastRequestSeen){var e=b("Vector").getElementPosition(a[d],"viewport").y;if(e>0&&e+b("Vector").getElementDimensions(a[d]).y<=c)break;d-=1}e=d;while(d>this._lastRequestSeen){c=a[d].getAttribute("data-id");var f={request_id:c,request_location:"friend_center_requests"};b("MarauderLogger").log("request_seen","friend_request_waterfall",f);b("FriendRequestIHEventLogger").logImpression(c);d-=1}this._lastRequestSeen=Math.max(this._lastRequestSeen,e)},_handleXout:function(){this._lastPymkSeen=Math.max(this._lastPymkSeen-1,-1),this._recordPYMKImpression()},logPYMKImpression:function(a,c){var d=b("DOM").find(a,"input.friendBrowserID");d=parseInt(d.value,10);var e=parseInt(a.getAttribute("data-signature"),10),f=null;a=b("DOMQuery").scry(a,"#common_group");a!==null&&a.length>0&&(f="common_group");b("PymkFunnelLogger").logImpression(d,e,c,f)}};e.exports=a}),null);
__d("RampUpPendingRequests",["AsyncRequest","CSS","DOM"],(function(a,b,c,d,e,f){__p&&__p();function g(a,c,d,e,f,g,h){this._id=d,this._ref=e,this._friendingLocation=f,this._friendingLocationRefs=g,this._confirmButton=a,this._deleteButton=c,this._responseSection=b("DOM").find(this._confirmButton,"^.ruResponse"),this._userBox=b("DOM").find(this._responseSection,"^.ruUserBox"),this._deleteButton.onclick=this._delete.bind(this),this._confirmButton.onclick=this._confirm.bind(this),this._loadingIndicator=b("DOM").find(this._responseSection,".ruResponseLoading"),this._viewer_id=h}Object.assign(g.prototype,{_send:function(a,c){b("DOM").remove(b("DOM").find(this._responseSection,".ruResponseButtons"));var d=b("DOM").find(this._userBox,".followUpQuestion"),e=b("DOM").find(this._userBox,".requestInfoContainer");a==="reject"?(b("CSS").hide(e),b("DOM").remove(b("DOM").find(this._userBox,".ruResponseSectionContainer")),b("CSS").show(d)):(b("CSS").show(this._loadingIndicator),this._loadingIndicator.focus());e=new(b("AsyncRequest"))().setURI("/requests/friends/ajax/").setData({action:a,id:this._id,ref:this._ref,floc:this._friendingLocation,frefs:this._friendingLocationRefs,viewer_id:this._viewer_id}).setTransportErrorHandler(function(){b("DOM").remove(this._loadingIndicator),b("DOM").remove(d),b("CSS").show(b("DOM").find(this._responseSection,".ruTransportErrorMsg"))}.bind(this));c&&e.setHandler(c);e.send()},_delete:function(){var a="reject";this._send(a)},_confirm:function(){this._send("confirm",function(a){b("CSS").hide(this._loadingIndicator);a=a.payload;b("DOM").setContent(this._responseSection,a.success?a.button.markup:a.err);a=b("DOM").find(this._responseSection,".friendButton");a.focus()}.bind(this))}});Object.assign(g,{hookUp:function(a,b,c,d,e,f,h){new g(a,b,c,d,e,f,h)}});e.exports=g}),null);